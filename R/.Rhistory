library(CBPS)
https://marucha.files.wordpress.com/2014/06/the-sociopath-next-door.pdf
set.seed(1)
k<-10
n<-5000
X<-matrix(rnorm(n*k),nrow=n)
X<-apply(X,2,scale)*2
beta<-rep(1,k)
beta[1]<-3
treat<-X%*%beta + rnorm(n, 0, 5)
# For some reason betas with a large outlier mess everything up and lead to gigantic variances
# Issue doesn't seem to be in sigmasq.  Invariant across lumpiness of betas, as expected
# Perhaps sd of treat.  That moves around
cb1<-CBPS(treat ~ X, method = "exact", twostep = TRUE, preprocess = TRUE)
summary(cb1)
